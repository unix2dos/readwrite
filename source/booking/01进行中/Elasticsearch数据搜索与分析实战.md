---
doc_type: weread-highlights-reviews
bookId: "3300057552"
author: 王深湛
cover: https://cdn.weread.qq.com/weread/cover/8/cpplatform_maamrrjyhwbembgxbpfdg5/t7_cpplatform_maamrrjyhwbembgxbpfdg51682672069.jpg
reviewCount: 0
noteCount: 13
isbn: 9787115603654
title: 《Elasticsearch数据搜索与分析实战》
date: 2023-08-28
---

---


## 封面

## 版权信息

## 内容提要

## 前言

## 原理篇


- 📌 关系数据库在使用时存在明显的短板，导致它的应用存在一些缺点。(1)性能差：当单表的数据量达到数百万条甚至数千万条时，即使采用一定的方法去优化SQL，查询速度依然可能很慢，这在很多业务场景中是不允许的。(2)扩展难：关系数据库的集群不太容易搭建，即使采用了分表分库的中间件将数据库集群化，查询性能在很多业务场景中依然没有保障 
    - ⏱ 2023-08-26 23:45:52 

- 📌 Elasticsearch很适合读多写少的数据分析型应用程序 
    - ⏱ 2023-08-26 23:47:39 

- 📌 你可能会感觉MySQL的查询速度越来越难以接受，也可能由于业务逻辑越来越复杂，而感觉HBase的检索方式不够丰富。这时候你可以考虑把那些查询速度慢或者业务逻辑复杂的数据接入Elasticsearch，使用时你需要把相关表的历史存量数据一次性导入Elasticsearch，当增量数据写入数据库时，也往Elasticsearch中写一份，这样就能够保证两边的数据是同步的 
    - ⏱ 2023-08-26 23:48:16 

- 📌 注意：当关系数据库或NoSQL数据库能够满足实际需要的查询请求时，则没有必要接入Elasticsearch。 
    - ⏱ 2023-08-26 23:48:43 

- 📌 Logstash是早期的数据采集、转换工具，你只需要编写配置文件就可以很方便地把各种数据写入Elasticsearch。但是由于Logstash运行时比较耗资源，于是官方又推出了一系列命名包含beat的轻量级数据采集器，统称为Beats，相当于把Logstash的数据采集功能分包给Beats工具完成。既可以把Beats采集的数据汇聚到Logstash后再写入Elasticsearch，也可以直接采集数据然后写入Elasticsearch。 
    - ⏱ 2023-08-26 23:50:25 

- 📌 (3)索引(index)：索引是存储数据的基本单元，在大多数情况下，可以把它理解为关系数据库中的表。(4)文档(document)：文档是写入索引的基本单元，一个文档就是索引中的一条数据。写入索引的文档是JSON格式的文本字符串，里面包含各个字段的信息，保存在索引的_source元数据中。 
    - ⏱ 2023-08-26 23:51:27 

- 📌 (5)分片(shard)：分片分为主分片和副本分片，每个索引拥有至少一个主分片和零个或多个副本分片，一个分片本质上是一个Lucene索引。当整个集群的节点数量增加或减少时，为了让分片在每个节点上分布得比较均匀，通常会使分片在集群中移动，这个过程也就是分片的分配。在任何时候，索引的主分片和它对应的副本分片不能位于同一个节点上，这是为了保证节点宕机时，主分片和副本分片不会同时丢失。(6)主分片(primary shard)：当文档数据写入索引时，会首先选择一个主分片进行写入，再把数据同步到副本分片。主分片的数目在建立索引时就已经固定，无法修改。如果一个索引拥有的主分片越多，那么它能存储的数据越多，主分片的个数通常跟索引的数据量成正相关。(7)副本分片(replica shard)：副本分片是主分片的一个副本，它能够分担一些数据搜索的请求，从而提高搜索的吞吐量。同时，副本分片还具备容灾备份的能力，当主分片所在的节点宕机时，副本分片可以被选举为主分片来保持数据的完整性。另外，索引的副本分片数目可以随时修改。 
    - ⏱ 2023-08-26 23:58:44 

- 📌 在Elasticsearch的config文件夹下，一共有3个重要的配置文件，其中elasticsearch.yml用于配置节点的参数，jvm.options用来配置Elasticsearch运行时占用的堆内存大小，log4j2.properties用来配置Elasticsearch运行时的日志参数。那些可以通过调用REST接口，在节点运行时动态修改的配置叫作动态配置；配置在elasticsearch.yml文件中，只能在集群重启后才能生效的配置叫作静态配置。 
    - ⏱ 2023-08-27 13:05:47 

- 📌 Elasticsearch不支持事务管理，它本身具有数据存储的功能。对于读多写少的数据分析型场景，可以将它作为唯一的数据源；也可以配合现有系统的数据库来使用它，能解决数据库查询慢的问题；还可以使用官方提供的Elastic Stack平台。 
    - ⏱ 2023-08-27 13:11:06 
## 第2章 深入原理


- 📌 数据采集模块负责采集需要搜索的数据源，很多网络爬虫可以快速地从各种网站上采集结构化的数据。对于Elasticsearch而言，数据采集模块既可以是官方指定的Beats工具，也可以是第三方提供的ETL工具，还可以是使用Java客户端写入的数据。总之，这个模块的目的就是把用户需要搜索的数据采集起来以备写入搜索引擎。为了提高采集数据的效率，可以使用多线程和分布式等手段，再配合一些比较好的采集策略（例如时间戳增量采集）来满足实际项目的需要。 
    - ⏱ 2023-08-28 09:01:45 

- 📌 。搜索引擎的索引数据是按照倒排索引的结构进行组织的。倒排索引是一种特殊的数据结构，它保存着每个词在索引中的文档编号以及它们出现在文档的位置。 
    - ⏱ 2023-08-28 12:07:15 

- 📌 搜索模块的功能是根据用户输入的查询文本找到索引中匹配的文档，相关度越高的文档排名越靠前。有了倒排索引的结构，搜索会变得很方便。假如用户在搜索时输入了“black phone”这样的文本，文本分析模块会把这个搜索文本拆分成分词“black”和“phone”，然后去倒排索引中寻找包含这两个词的文档。此时很容易查出文档2和文档3都含有这两个文本。在返回最终的搜索结果时，搜索引擎会使用一套相关度计算公式来计算每个搜索结果与搜索文本的相关度分值，然后把搜索结果列表按照相关度分值由高到低进行返回。 
    - ⏱ 2023-08-28 09:04:23 

- 📌 节点的发现过程是递归的。即使某个节点的discovery.seed_hosts不包含集群的主节点，只要它可以通过列表中的节点间接地找到主节点，就能被主节点纳入集群。 
    - ⏱ 2023-08-28 09:06:27 
## 应用篇

## 第4章 文本分析

## 第5章 搜索数据

## 第6章 聚集统计

## 第7章 父子关联

## 第8章 Java高级客户端编程

## 第9章 集群扩展和性能优化

## 发散篇

## 第11章 Kibana：数据可视化利器

## 第12章 Beats家族：精细化数据采集


# 读书笔记


# 本书评论
